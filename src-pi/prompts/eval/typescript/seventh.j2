Create a query builder where table schemas and query results are fully typed.
API:

typescript
const schema = {
  users: { id: 'number', name: 'string', email: 'string' },
  posts: { id: 'number', userId: 'number', title: 'string' },
} as const;

const query = db(schema)
  .select('users')
  .where('id', '=', 123)
  .fields('id', 'name');

type Result = Infer<typeof query>; // { id: number; name: string }[]
Requirements:

Use mapped types to convert schema to typed objects.

.select(), .where(), .fields() return new query objects with updated types.

.fields() narrows return type to selected columns.

Support joins with type-safe foreign keys.
Implementation:

Chain builder pattern with generics tracking state.

Use as const and typeof for schema inference.

Conditional types for filtering selected fields.
Tests:

Type inference from schema.

Field selection type narrowing.

Type errors for non-existent fields/tables.