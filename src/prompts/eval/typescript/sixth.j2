Implement a finite state machine where states and valid transitions are type-checked.
API:

typescript
type States = {
  idle: {};
  loading: { startTime: number };
  success: { data: string };
  error: { message: string };
};

type Transitions = {
  idle: 'START_LOADING';
  loading: 'LOAD_SUCCESS' | 'LOAD_ERROR';
  success: never;
  error: 'RETRY';
};

const machine = createMachine<States, Transitions>({ initial: 'idle' });
machine.transition('START_LOADING', { startTime: Date.now() }); // OK
machine.transition('LOAD_SUCCESS', { data: 'result' }); // Type error if not in 'loading'
Requirements:

Current state tracked with discriminated union.

.transition() only accepts valid events for current state.

State data must match the target state's shape.

Support guards/actions (functions executed on transition).
Tests:

Valid transitions.

Type errors for invalid transitions.

State context updates.